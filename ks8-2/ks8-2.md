# Kubernetes series part 8-2

The objective of this tutorial is to prevent losing the data from our todo_list application. We'll achieve that via using a database that lives externally to our cluster. 

Even though the database is outside of the Kubernetes cluster, we'll still take advantage of Kubernetes services to allow our Python web application to connect to the external service.

**Note that the code changes in this episode are based off of ks8-1.**

## Code changes

1. Remove the `ks.database.deployment.yaml` since we won't use a database in a cluster in this episode.

    ```bash
    ➜ pwd
        ~/dev/github/redgate/ks/ks8-1
    ➜ rm ./ks/templates/ks.database.deployment.yaml
    ```

1. Install and configure a PostgreSQL database on your host machine

    See the [download & installation documentation](https://www.postgresql.org/download/) for your operating system

    Ensure that any configuration matches the contents of the `Values.yaml` file in the helm chart.
    For example, ensure the database name, database user name and port are all the same as defined in `Values.yaml`.

1. Edit the `ks.database.service.yaml` to map to our local PostgreSQL installation

    Replace the contents of the file with the following:
    
    ```yaml
    apiVersion: v1
    kind: Service
    metadata:
    name: {{ .Release.Name }}-dbservice
    spec:
    type: ExternalName
    externalName: {{ .Values.database.externalName }}
    ```

1. Add an 'externalName' entry to your `Values.yaml` file

    ```yaml
    externalName: 192.168.64.1
    ```

    *NOTE*: The IP address used above is for the `xhyve` driver in Minikube.
    Depending on which driver you use, you will need to use a different IP address to connect out to the host machine.

    See [here for more information](https://github.com/kubernetes/minikube/blob/5f6075b2918e096dec30aecdd4e117c3c13f8e49/pkg/minikube/cluster/cluster.go#L287)

1. // todo: setup steps for running the app